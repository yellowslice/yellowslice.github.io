function launch(){launchFrom(mousePos.x)}function launchFrom(a){if(rockets.length<10){var b=new Rocket(a);b.explosionColor=10*Math.floor(360*Math.random()/10),b.vel.y=Math.random()*-3-4,b.vel.x=6*Math.random()-3,b.size=8,b.shrink=.999,b.gravity=.01,rockets.push(b)}}function loop(){SCREEN_WIDTH!=window.innerWidth&&(canvas.width=SCREEN_WIDTH=window.innerWidth),SCREEN_HEIGHT!=window.innerHeight&&(canvas.height=SCREEN_HEIGHT=window.innerHeight),context.fillStyle="rgba(0, 0, 0, 0.05)",context.fillRect(0,0,SCREEN_WIDTH,SCREEN_HEIGHT);for(var a=[],b=0;b<rockets.length;b++){rockets[b].update(),rockets[b].render(context);var c=Math.sqrt(Math.pow(mousePos.x-rockets[b].pos.x,2)+Math.pow(mousePos.y-rockets[b].pos.y,2)),d=rockets[b].pos.y<2*SCREEN_HEIGHT/3&&100*Math.random()<=1;rockets[b].pos.y<SCREEN_HEIGHT/5||rockets[b].vel.y>=0||c<50||d?rockets[b].explode():a.push(rockets[b])}rockets=a;for(var e=[],b=0;b<particles.length;b++)particles[b].update(),particles[b].exists()&&(particles[b].render(context),e.push(particles[b]));for(particles=e;particles.length>MAX_PARTICLES;)particles.shift()}function Particle(a){this.pos={x:a?a.x:0,y:a?a.y:0},this.vel={x:0,y:0},this.shrink=.97,this.size=2,this.resistance=1,this.gravity=0,this.flick=!1,this.alpha=1,this.fade=0,this.color=0}function Rocket(a){Particle.apply(this,[{x:a,y:SCREEN_HEIGHT}]),this.explosionColor=0}!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a,a.document)}):"undefined"!=typeof module&&module.exports?module.exports=b(a,a.document):a.Shake=b(a,a.document)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(c){if(this.hasDeviceMotion="ondevicemotion"in a,this.options={threshold:15,timeout:1e3},"object"==typeof c)for(var d in c)c.hasOwnProperty(d)&&(this.options[d]=c[d]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof b.CustomEvent)this.event=new b.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof b.createEvent)return!1;this.event=b.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return c.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},c.prototype.start=function(){this.reset(),this.hasDeviceMotion&&a.addEventListener("devicemotion",this,!1)},c.prototype.stop=function(){this.hasDeviceMotion&&a.removeEventListener("devicemotion",this,!1),this.reset()},c.prototype.devicemotion=function(b){var d,e,c=b.accelerationIncludingGravity,f=0,g=0,h=0;return null===this.lastX&&null===this.lastY&&null===this.lastZ?(this.lastX=c.x,this.lastY=c.y,void(this.lastZ=c.z)):(f=Math.abs(this.lastX-c.x),g=Math.abs(this.lastY-c.y),h=Math.abs(this.lastZ-c.z),(f>this.options.threshold&&g>this.options.threshold||f>this.options.threshold&&h>this.options.threshold||g>this.options.threshold&&h>this.options.threshold)&&(d=new Date,e=d.getTime()-this.lastTime.getTime(),e>this.options.timeout&&(a.dispatchEvent(this.event),this.lastTime=new Date)),this.lastX=c.x,this.lastY=c.y,void(this.lastZ=c.z))},c.prototype.handleEvent=function(a){if("function"==typeof this[a.type])return this[a.type](a)},c});var SCREEN_WIDTH=window.innerWidth,SCREEN_HEIGHT=window.innerHeight,mousePos={x:400,y:300},canvas=document.createElement("canvas"),context=canvas.getContext("2d"),particles=[],rockets=[],MAX_PARTICLES=400,colorCode=0;$(document).ready(function(){$("#fireTab").append(canvas),canvas.width=SCREEN_WIDTH,canvas.height=SCREEN_HEIGHT,setInterval(launch,800),setInterval(loop,20)}),$(document).mousemove(function(a){a.preventDefault(),mousePos={x:a.clientX,y:a.clientY}}),$(document).mousedown(function(a){for(var b=0;b<5;b++)launchFrom(Math.random()*SCREEN_WIDTH*2/3+SCREEN_WIDTH/6)}),Particle.prototype.update=function(){this.vel.x*=this.resistance,this.vel.y*=this.resistance,this.vel.y+=this.gravity,this.pos.x+=this.vel.x,this.pos.y+=this.vel.y,this.size*=this.shrink,this.alpha-=this.fade},Particle.prototype.render=function(a){if(this.exists()){a.save(),a.globalCompositeOperation="lighter";var b=this.pos.x,c=this.pos.y,d=this.size/2,e=a.createRadialGradient(b,c,.1,b,c,d);e.addColorStop(.1,"rgba(255,255,255,"+this.alpha+")"),e.addColorStop(.8,"hsla("+this.color+", 100%, 50%, "+this.alpha+")"),e.addColorStop(1,"hsla("+this.color+", 100%, 50%, 0.1)"),a.fillStyle=e,a.beginPath(),a.arc(this.pos.x,this.pos.y,this.flick?Math.random()*this.size:this.size,0,2*Math.PI,!0),a.closePath(),a.fill(),a.restore()}},Particle.prototype.exists=function(){return this.alpha>=.1&&this.size>=1},Rocket.prototype=new Particle,Rocket.prototype.constructor=Rocket,Rocket.prototype.explode=function(){for(var a=10*Math.random()+80,b=0;b<a;b++){var c=new Particle(this.pos),d=Math.random()*Math.PI*2,e=15*Math.cos(Math.random()*Math.PI/2);c.vel.x=Math.cos(d)*e,c.vel.y=Math.sin(d)*e,c.size=10,c.gravity=.2,c.resistance=.92,c.shrink=.05*Math.random()+.93,c.flick=!0,c.color=this.explosionColor,particles.push(c)}},Rocket.prototype.render=function(a){if(this.exists()){a.save(),a.globalCompositeOperation="lighter";var b=this.pos.x,c=this.pos.y,d=this.size/2,e=a.createRadialGradient(b,c,.1,b,c,d);e.addColorStop(.1,"rgba(255, 255, 255 ,"+this.alpha+")"),e.addColorStop(1,"rgba(0, 0, 0, "+this.alpha+")"),a.fillStyle=e,a.beginPath(),a.arc(this.pos.x,this.pos.y,this.flick?Math.random()*this.size/2+this.size/2:this.size,0,2*Math.PI,!0),a.closePath(),a.fill(),a.restore()}};